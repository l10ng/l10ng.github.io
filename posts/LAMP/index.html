<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>LAMP在Centos6.8下的編譯安裝與設置 | l10ng's</title><meta name="description" content="LAMP在Centos6.8下的編譯安裝與設置"><meta name="keywords" content="linux,lamp,centos"><meta name="author" content="l10ng"><meta name="copyright" content="l10ng"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/l10ng/image@1.2/favicon.png"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="LAMP在Centos6.8下的編譯安裝與設置"><meta name="twitter:description" content="LAMP在Centos6.8下的編譯安裝與設置"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/l10ng/image@1.2/cover/cover60.jpg"><meta property="og:type" content="article"><meta property="og:title" content="LAMP在Centos6.8下的編譯安裝與設置"><meta property="og:url" content="https://l10ng.github.io/posts/LAMP/"><meta property="og:site_name" content="l10ng's"><meta property="og:description" content="LAMP在Centos6.8下的編譯安裝與設置"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/l10ng/image@1.2/cover/cover60.jpg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://l10ng.github.io/posts/LAMP/"><link rel="prev" title="kali設置ss+proxychains透明代理" href="https://l10ng.github.io/posts/ss-proxychains/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">l10ng's</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 日誌</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 關於</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音樂</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fa fa-coffee"></i><span> 留言</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/l10ng/image@1.2/avatar.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/l10ng/image@1.2/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">3</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">9</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">2</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 日誌</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 關於</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音樂</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fa fa-coffee"></i><span> 留言</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#gt-LAMP-以下"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">&gt; LAMP 以下</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#apache-httpd"><span class="toc_mobile_items-number">1.1.1.</span> <span class="toc_mobile_items-text">apache-httpd</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#mysql"><span class="toc_mobile_items-number">1.1.2.</span> <span class="toc_mobile_items-text">mysql</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#mysql多实例"><span class="toc_mobile_items-number">1.1.3.</span> <span class="toc_mobile_items-text">mysql多实例</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#php"><span class="toc_mobile_items-number">1.1.4.</span> <span class="toc_mobile_items-text">php</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#xcache"><span class="toc_mobile_items-number">1.1.5.</span> <span class="toc_mobile_items-text">xcache</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#gt-LAMP-以上"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">&gt; LAMP 以上</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#gt-LAMP-以下"><span class="toc-number">1.</span> <span class="toc-text">&gt; LAMP 以下</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓"><span class="toc-number">1.1.</span> <span class="toc-text">↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#apache-httpd"><span class="toc-number">1.1.1.</span> <span class="toc-text">apache-httpd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql"><span class="toc-number">1.1.2.</span> <span class="toc-text">mysql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql多实例"><span class="toc-number">1.1.3.</span> <span class="toc-text">mysql多实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php"><span class="toc-number">1.1.4.</span> <span class="toc-text">php</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xcache"><span class="toc-number">1.1.5.</span> <span class="toc-text">xcache</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#gt-LAMP-以上"><span class="toc-number">2.</span> <span class="toc-text">&gt; LAMP 以上</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/l10ng/image@1.2/cover/cover60.jpg)"><div id="post-info"><div id="post-title"><div class="posttitle">LAMP在Centos6.8下的編譯安裝與設置</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-02-01<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-02-02</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E9%81%8B%E7%B6%AD/">運維</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="gt-LAMP-以下"><a href="#gt-LAMP-以下" class="headerlink" title="&gt; LAMP 以下"></a>&gt; LAMP 以下</h1><h2 id="↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓"><a href="#↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓" class="headerlink" title="↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓"></a>↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓</h2><h3 id="apache-httpd"><a href="#apache-httpd" class="headerlink" title="apache-httpd"></a>apache-httpd</h3><hr>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; apr环境</span><br><span class="line"><span class="comment"># wget http://mirrors.cnnic.cn/apache//apr/apr-1.5.2.tar.gz</span></span><br><span class="line"><span class="comment"># wget http://mirrors.cnnic.cn/apache//apr/apr-util-1.5.4.tar.gz</span></span><br><span class="line"><span class="comment"># tar xf apr-1.5.2.tar.gz</span></span><br><span class="line"><span class="comment"># cd apr-1.5.2</span></span><br><span class="line"><span class="comment"># ./configure --prefix=/usr/local/apr</span></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br><span class="line"><span class="comment"># tar xf apr-util-1.5.4.tar.gz</span></span><br><span class="line"><span class="comment"># cd apr-util-1.5.4</span></span><br><span class="line"><span class="comment"># ./configure --prefix=/usr/local/apr-util --with-apr=/usr/local/apr</span></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>httpd安装</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wget http://mirror.bit.edu.cn/apache//httpd/httpd-2.4.23.tar.gz</span></span><br><span class="line"><span class="comment"># tar xf httpd-2.4.23.tar.gz</span></span><br><span class="line"><span class="comment"># cd httpd-2.4.23</span></span><br><span class="line">./configure \</span><br><span class="line">--prefix=/usr/<span class="built_in">local</span>/httpd \</span><br><span class="line">--sysconfdir=/etc \</span><br><span class="line">--with-apr=/usr/<span class="built_in">local</span>/apr \</span><br><span class="line">--with-apr-util=/usr/<span class="built_in">local</span>/apr-util \</span><br><span class="line">--with-pcre \</span><br><span class="line">--with-mpm=event \ 			<span class="comment">#event模型</span></span><br><span class="line">--with-libxml2 \</span><br><span class="line">--with-zib \</span><br><span class="line">--<span class="built_in">enable</span>-ssl \</span><br><span class="line">--<span class="built_in">enable</span>-so \</span><br><span class="line">--<span class="built_in">enable</span>-mbstring \</span><br><span class="line">--<span class="built_in">enable</span>-rewrite \</span><br><span class="line">--<span class="built_in">enable</span>-modules=all \</span><br><span class="line">--<span class="built_in">enable</span>-mods-shared=all \</span><br><span class="line">--<span class="built_in">enable</span>-mpms-shared=all \</span><br><span class="line">--<span class="built_in">enable</span>-cgid \ 				<span class="comment">#event模型中使用cgid</span></span><br><span class="line">--<span class="built_in">enable</span>-proxy \				<span class="comment">#开启代理支持</span></span><br><span class="line">--<span class="built_in">enable</span>-proxy-fcgi				<span class="comment">#开启代理支持php</span></span><br><span class="line"></span><br><span class="line">--<span class="built_in">enable</span>-proxy-http \ 			<span class="comment">#开启代理http，一般代理tomcat和其它http协议</span></span><br><span class="line">--<span class="built_in">enable</span>-proxy-ajp \ 			<span class="comment">#开启apache二进制传输协议，一般代理tomcat</span></span><br><span class="line">--<span class="built_in">enable</span>-proxy-balancer \ 		<span class="comment">#开启代理负载均衡</span></span><br><span class="line">--<span class="built_in">enable</span>-lbmethod-heartbeat \	<span class="comment">#开启负载均衡心跳检测，以下为心跳检测功能</span></span><br><span class="line">--<span class="built_in">enable</span>-heartbeat \ 			<span class="comment">#开启心跳检测</span></span><br><span class="line">--<span class="built_in">enable</span>-slotmem-shm \ 			<span class="comment">#</span></span><br><span class="line">--<span class="built_in">enable</span>-slotmem-plain \</span><br><span class="line">--<span class="built_in">enable</span>-watchdog</span><br><span class="line"></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>环境配置</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/profile.d/httpd.sh</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/httpd/bin</span><br><span class="line"><span class="built_in">source</span> /etc/profile.d/httpd.sh</span><br><span class="line">vim /etc/man.config</span><br><span class="line">MAN /usr/<span class="built_in">local</span>/httpd/man</span><br><span class="line"><span class="comment"># ln -sv /usr/local/httpd/include /usr/include/httpd</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># vim /etc/init.d/httpd</span></span><br><span class="line">=========================启动脚本开始========================================</span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># httpd        Startup script for the Apache HTTP Server</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># chkconfig: - 85 15</span></span><br><span class="line"><span class="comment"># description: The Apache HTTP Server is an efficient and extensible  \</span></span><br><span class="line"><span class="comment">#              server implementing the current HTTP standards.</span></span><br><span class="line"><span class="comment"># processname: httpd</span></span><br><span class="line"><span class="comment"># config: /etc/httpd/conf/httpd.conf</span></span><br><span class="line"><span class="comment"># config: /etc/sysconfig/httpd</span></span><br><span class="line"><span class="comment"># pidfile: /var/run/httpd/httpd.pid</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">### BEGIN INIT INFO</span></span><br><span class="line"><span class="comment"># Provides: httpd</span></span><br><span class="line"><span class="comment"># Required-Start: $local_fs $remote_fs $network $named</span></span><br><span class="line"><span class="comment"># Required-Stop: $local_fs $remote_fs $network</span></span><br><span class="line"><span class="comment"># Should-Start: distcache</span></span><br><span class="line"><span class="comment"># Short-Description: start and stop Apache HTTP Server</span></span><br><span class="line"><span class="comment"># Description: The Apache HTTP Server is an extensible server </span></span><br><span class="line"><span class="comment">#  implementing the current HTTP standards.</span></span><br><span class="line"><span class="comment">### END INIT INFO</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Source function library.</span></span><br><span class="line">. /etc/rc.d/init.d/<span class="built_in">functions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -f /etc/sysconfig/httpd ]; <span class="keyword">then</span></span><br><span class="line">        . /etc/sysconfig/httpd</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Start httpd in the C locale by default.</span></span><br><span class="line">HTTPD_LANG=<span class="variable">$&#123;HTTPD_LANG-"C"&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This will prevent initlog from swallowing up a pass-phrase prompt if</span></span><br><span class="line"><span class="comment"># mod_ssl needs a pass-phrase from the user.</span></span><br><span class="line">INITLOG_ARGS=<span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set HTTPD=/usr/sbin/httpd.worker in /etc/sysconfig/httpd to use a server</span></span><br><span class="line"><span class="comment"># with the thread-based "worker" MPM; BE WARNED that some modules may not</span></span><br><span class="line"><span class="comment"># work correctly with a thread-based MPM; notably PHP will refuse to start.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Path to the apachectl script, server binary, and short-form for messages.</span></span><br><span class="line">apachectl=/usr/<span class="built_in">local</span>/httpd/bin/apachectl</span><br><span class="line">httpd=<span class="variable">$&#123;HTTPD-/usr/local/httpd/bin/httpd&#125;</span></span><br><span class="line">prog=httpd</span><br><span class="line">pidfile=<span class="variable">$&#123;PIDFILE-/var/run/httpd.pid&#125;</span></span><br><span class="line">lockfile=<span class="variable">$&#123;LOCKFILE-/var/lock/subsys/httpd&#125;</span></span><br><span class="line">RETVAL=0</span><br><span class="line">STOP_TIMEOUT=<span class="variable">$&#123;STOP_TIMEOUT-10&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The semantics of these two functions differ from the way apachectl does</span></span><br><span class="line"><span class="comment"># things -- attempting to start while running is a failure, and shutdown</span></span><br><span class="line"><span class="comment"># when not running is also a failure.  So we just do it the way init scripts</span></span><br><span class="line"><span class="comment"># are expected to behave here.</span></span><br><span class="line"><span class="function"><span class="title">start</span></span>() &#123;</span><br><span class="line">        <span class="built_in">echo</span> -n $<span class="string">"Starting <span class="variable">$prog</span>: "</span></span><br><span class="line">        LANG=<span class="variable">$HTTPD_LANG</span> daemon --pidfile=<span class="variable">$&#123;pidfile&#125;</span> <span class="variable">$httpd</span> <span class="variable">$OPTIONS</span></span><br><span class="line">        RETVAL=$?</span><br><span class="line">        echo_failure</span><br><span class="line">        [ <span class="variable">$RETVAL</span> = 0 ] &amp;&amp; touch <span class="variable">$&#123;lockfile&#125;</span></span><br><span class="line">        <span class="built_in">return</span> <span class="variable">$RETVAL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># When stopping httpd, a delay (of default 10 second) is required</span></span><br><span class="line"><span class="comment"># before SIGKILLing the httpd parent; this gives enough time for the</span></span><br><span class="line"><span class="comment"># httpd parent to SIGKILL any errant children.</span></span><br><span class="line"><span class="function"><span class="title">stop</span></span>() &#123;</span><br><span class="line">        status -p <span class="variable">$&#123;pidfile&#125;</span> <span class="variable">$httpd</span> &gt; /dev/null</span><br><span class="line">        <span class="keyword">if</span> [[ $? = 0 ]]; <span class="keyword">then</span></span><br><span class="line">                <span class="built_in">echo</span> -n $<span class="string">"Stopping <span class="variable">$prog</span>: "</span></span><br><span class="line">                killproc -p <span class="variable">$&#123;pidfile&#125;</span> -d <span class="variable">$&#123;STOP_TIMEOUT&#125;</span> <span class="variable">$httpd</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">echo</span> -n $<span class="string">"Stopping <span class="variable">$prog</span>: "</span></span><br><span class="line">                success</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        RETVAL=$?</span><br><span class="line">        <span class="built_in">echo</span></span><br><span class="line">        [ <span class="variable">$RETVAL</span> = 0 ] &amp;&amp; rm -f <span class="variable">$&#123;lockfile&#125;</span> <span class="variable">$&#123;pidfile&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">reload</span></span>() &#123;</span><br><span class="line">    <span class="built_in">echo</span> -n $<span class="string">"Reloading <span class="variable">$prog</span>: "</span></span><br><span class="line">    <span class="keyword">if</span> ! LANG=<span class="variable">$HTTPD_LANG</span> <span class="variable">$httpd</span> <span class="variable">$OPTIONS</span> -t &gt;&amp;/dev/null; <span class="keyword">then</span></span><br><span class="line">        RETVAL=6</span><br><span class="line">        <span class="built_in">echo</span> $<span class="string">"not reloading due to configuration syntax error"</span></span><br><span class="line">        failure $<span class="string">"not reloading <span class="variable">$httpd</span> due to configuration syntax error"</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="comment"># Force LSB behaviour from killproc</span></span><br><span class="line">        LSB=1 killproc -p <span class="variable">$&#123;pidfile&#125;</span> <span class="variable">$httpd</span> -HUP</span><br><span class="line">        RETVAL=$?</span><br><span class="line">        <span class="keyword">if</span> [ <span class="variable">$RETVAL</span> -eq 7 ]; <span class="keyword">then</span></span><br><span class="line">            failure $<span class="string">"httpd shutdown"</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># See how we were called.</span></span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">  start)</span><br><span class="line">        start</span><br><span class="line">        ;;</span><br><span class="line">  stop)</span><br><span class="line">        stop</span><br><span class="line">        ;;</span><br><span class="line">  status)</span><br><span class="line">        status -p <span class="variable">$&#123;pidfile&#125;</span> <span class="variable">$httpd</span></span><br><span class="line">        RETVAL=$?</span><br><span class="line">        ;;</span><br><span class="line">  restart)</span><br><span class="line">        stop</span><br><span class="line">        start</span><br><span class="line">        ;;</span><br><span class="line">  condrestart|try-restart)</span><br><span class="line">        <span class="keyword">if</span> status -p <span class="variable">$&#123;pidfile&#125;</span> <span class="variable">$httpd</span> &gt;&amp;/dev/null; <span class="keyword">then</span></span><br><span class="line">                stop</span><br><span class="line">                start</span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        ;;</span><br><span class="line">  force-reload|reload)</span><br><span class="line">        reload</span><br><span class="line">        ;;</span><br><span class="line">  graceful|<span class="built_in">help</span>|configtest|fullstatus)</span><br><span class="line">        <span class="variable">$apachectl</span> <span class="variable">$@</span></span><br><span class="line">        RETVAL=$?</span><br><span class="line">        ;;</span><br><span class="line">  *)</span><br><span class="line">        <span class="built_in">echo</span> $<span class="string">"Usage: <span class="variable">$prog</span> &#123;start|stop|restart|condrestart|try-restart|force-reload|reload|status|fullstatus|graceful|help|configtest&#125;"</span></span><br><span class="line">        RETVAL=2</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> <span class="variable">$RETVAL</span></span><br><span class="line"></span><br><span class="line">=============================启动脚本结束=========================================================</span><br><span class="line"></span><br><span class="line"><span class="comment"># chmod +x /etc/init.d/httpd</span></span><br><span class="line"><span class="comment"># chkconfig --add httpd</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>配置文件</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/httpd/httpd.conf</span></span><br><span class="line">注释掉: DocumentRoot <span class="string">"/usr/local/httpd/htdocs"</span></span><br><span class="line"></span><br><span class="line">PidFile <span class="string">"/var/run/httpd.pid"</span></span><br><span class="line">Include /etc/httpd/extra/httpd-vhosts.conf</span><br><span class="line">Index index.php index.html index.htm</span><br><span class="line"></span><br><span class="line">vim /etc/httpd/extra/httpd-vhosts.conf</span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">	ServerName ha1.yzio.com</span><br><span class="line">	DocumentRoot <span class="string">"/www/html"</span></span><br><span class="line">	proxyrequest off		; 关掉正向代理，启用反向代理</span><br><span class="line">	proxypassmatch ^/(.*\.php(/.*)?)$ fcgi://127.0.0.1:9000/www/html/<span class="variable">$1</span></span><br><span class="line">	&lt;directory <span class="string">"/www/html"</span>&gt;</span><br><span class="line">		options none</span><br><span class="line">		AllowOverride none</span><br><span class="line">		required all granted</span><br><span class="line">	&lt;/directory&gt;</span><br><span class="line">	Errorlog <span class="string">"/var/log/ha1.yzio.com_error"</span></span><br><span class="line">	CustomLog <span class="string">"/var/log/ha1.yzio.com_access"</span> common</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></div>

<h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><hr>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; 工作用户、目录准备</span><br><span class="line"><span class="comment"># groupadd -g 306 mysql</span></span><br><span class="line"><span class="comment"># useradd -g 306 -u 306 -r -s /sbin/nologin -M mysql</span></span><br><span class="line"><span class="comment"># mkdir /mydata/data</span></span><br><span class="line"><span class="comment"># chown -R mysql.mysql /mydata/data</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>通用二进制安装</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wget http://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.15-linux-glibc2.5-x86_64.tar.gz</span></span><br><span class="line"><span class="comment"># tar xf mysql-5.7.15-linux-glibc2.5-x86_64.tar.gz -C /usr/local</span></span><br><span class="line"><span class="comment"># cd /usr/local</span></span><br><span class="line"><span class="comment"># ln -sv mysql-5.7.15-linux-glibc2.5-x86_64 mysql</span></span><br><span class="line"><span class="comment"># cd mysql</span></span><br><span class="line"><span class="comment"># chmod -R mysql.mysql ./*</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>环境准备</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/profile.d/mysqld.sh</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/mysql/bin</span><br><span class="line"><span class="comment"># source /etc/profile.d/mysqld.sh</span></span><br><span class="line"><span class="comment"># vim /etc/ld.so.conf.d/mysqld.conf</span></span><br><span class="line">/usr/<span class="built_in">local</span>/mysql/lib</span><br><span class="line"><span class="comment"># ldconfig</span></span><br><span class="line"><span class="comment"># ldconfig -p | grep mysql</span></span><br><span class="line"><span class="comment"># vim /etc/man.config</span></span><br><span class="line">MAN /usr/<span class="built_in">local</span>/mysql/man</span><br><span class="line"><span class="comment"># ls -sv /usr/local/mysql/include /usr/include/mysqld</span></span><br><span class="line"><span class="comment"># cp support-files/my.cnf-production /etc/my.cnf</span></span><br><span class="line"><span class="comment"># cp support-files/mysql.server /etc/init.d/mysqld</span></span><br><span class="line"><span class="comment"># chmod +x /etc/init.d/mysqld</span></span><br><span class="line"><span class="comment"># chkconfig --add mysqld</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># vim /etc/my.cnf</span></span><br><span class="line">basedir = /usr/<span class="built_in">local</span>/mysql</span><br><span class="line">datadir = /mydata/data</span><br><span class="line">innodb_file_per_table = 1</span><br><span class="line">log_bin = master-bin</span><br><span class="line">log_bin_index = master-bin.index</span><br><span class="line">binlog_format = mixed</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>初始化</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># bin/mysql --initialize --user=mysql --datadir=/mydata/data --basedir=/usr/local/mysql</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>查看密码 在初始化过程回显中，或</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cat /root/.mysql_secret</span></span><br><span class="line"><span class="comment"># mysql -uroot -p</span></span><br><span class="line">输入上面的默认密码</span><br><span class="line">mysql&gt; SET PASSWORD = PASSWORD(<span class="string">'dldkshja'</span>);</span><br><span class="line">mysql&gt; SHOW DATABASES;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>全库备份</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mysql -uroot -p -e "SHOW DATABASES;" | grep -Evi "database|information|performance" | sed -r 's@^([a-z].*$)@mysqldump -uroot -p"dldkshja" -B \1 | gzip &gt; /root/\1.sql.gz@g' | bash &amp;&gt; /dev/null</span></span><br></pre></td></tr></table></figure></div>

<h3 id="mysql多实例"><a href="#mysql多实例" class="headerlink" title="mysql多实例"></a>mysql多实例</h3><blockquote>
<blockquote>
<p>编译安装参数</p>
</blockquote>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cmake . -DCMAKE_INSTALL_PREFIX=/usr/<span class="built_in">local</span>/mysql \</span><br><span class="line">-DMYSQL_DATADIR=/mydata/data \</span><br><span class="line">-DSYSCONFDIR=/etc -DWITH_SSL=1 \</span><br><span class="line">-DWITH_INNOBASE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_ARCHIVE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_READLINE=1 \</span><br><span class="line">-DWITH_SSL=system \</span><br><span class="line">-DWITH_ZLIB=system \</span><br><span class="line">-DWITH_LIBWRAP=0 \</span><br><span class="line">-DMYSQL_UNIX_ADDR=/tmp/mysql.sock</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># groupadd -g 306 mysql</span></span><br><span class="line"><span class="comment"># useradd -g 306 -u 306 -r -s /sbin/nologin -M mysql</span></span><br><span class="line"><span class="comment"># mkdir /mydata/&#123;3306,3307&#125;/data -pv</span></span><br><span class="line"><span class="comment"># chown -R mysql.mysql /mydata/</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>通用二进制安装</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wget http://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.15-linux-glibc2.5-x86_64.tar.gz</span></span><br><span class="line"><span class="comment"># tar xf mysql-5.7.15-linux-glibc2.5-x86_64.tar.gz -C /usr/local</span></span><br><span class="line"><span class="comment"># cd /usr/local</span></span><br><span class="line"><span class="comment"># ln -sv mysql-5.7.15-linux-glibc2.5-x86_64 mysql</span></span><br><span class="line"><span class="comment"># cd mysql</span></span><br><span class="line"><span class="comment"># chmod -R mysql.mysql ./*</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>环境准备</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/profile.d/mysqld.sh</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/mysql/bin</span><br><span class="line"><span class="comment"># source /etc/profile.d/mysqld.sh</span></span><br><span class="line"><span class="comment"># vim /etc/ld.so.conf.d/mysqld.conf</span></span><br><span class="line">/usr/<span class="built_in">local</span>/mysql/lib</span><br><span class="line"><span class="comment"># ldconfig</span></span><br><span class="line"><span class="comment"># ldconfig -p | grep mysql</span></span><br><span class="line"><span class="comment"># vim /etc/man.config</span></span><br><span class="line">MAN /usr/<span class="built_in">local</span>/mysql/man</span><br><span class="line"><span class="comment"># ls -sv /usr/local/mysql/include /usr/include/mysqld</span></span><br></pre></td></tr></table></figure></div>


<blockquote>
<blockquote>
<p>配置mysqld启动脚本</p>
</blockquote>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /mydata/3306/mysqld</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># chkconfig: 345 43 57</span></span><br><span class="line"><span class="comment"># description: mysqld-master</span></span><br><span class="line"> </span><br><span class="line">. /etc/init.d/<span class="built_in">functions</span></span><br><span class="line">port=3306</span><br><span class="line">mysql_user=<span class="string">"root"</span></span><br><span class="line">mysql_pwd=<span class="string">"dldkshja"</span></span><br><span class="line">cmdPath=<span class="string">"/usr/local/mysql/bin"</span></span><br><span class="line">mysql_sock=/mydata/<span class="variable">$&#123;port&#125;</span>/mysql.sock</span><br><span class="line">conf_file=/mydata/<span class="variable">$&#123;port&#125;</span>/my.cnf</span><br><span class="line">prog=<span class="string">"MySQL"</span></span><br><span class="line">pid_file=/mydata/<span class="variable">$&#123;port&#125;</span>/mysql.pid</span><br><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">start</span></span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> [ -e <span class="string">"<span class="variable">$mysql_sock</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">                action <span class="string">"<span class="variable">$prog</span> is running..."</span></span><br><span class="line">                <span class="built_in">exit</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">                <span class="variable">$cmdPath</span>/mysqld_safe --defaults-file=<span class="variable">$&#123;conf_file&#125;</span> &amp;&gt; /dev/null &amp;</span><br><span class="line">                sleep 5</span><br><span class="line">                <span class="keyword">if</span> [ -e <span class="variable">$pid_file</span> ]; <span class="keyword">then</span></span><br><span class="line">                        action <span class="string">"Starting <span class="variable">$prog</span>: "</span> /bin/<span class="literal">true</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                        action <span class="string">"Starting <span class="variable">$prog</span>: "</span> /bin/<span class="literal">false</span></span><br><span class="line">                <span class="keyword">fi</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">stop</span></span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> [ -e <span class="string">"<span class="variable">$mysql_sock</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">                <span class="variable">$cmdPath</span>/mysqladmin -u<span class="variable">$mysql_user</span> -p<span class="variable">$mysql_pwd</span> -S <span class="variable">$&#123;mysql_sock&#125;</span> shutdown &amp;&gt; /dev/null</span><br><span class="line">                action <span class="string">"Stopping <span class="variable">$prog</span>"</span> /bin/<span class="literal">true</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">                action <span class="string">"<span class="variable">$prog</span> is stopped..."</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">        start)</span><br><span class="line">                start</span><br><span class="line">                ;;</span><br><span class="line">        stop)</span><br><span class="line">                stop</span><br><span class="line">                ;;</span><br><span class="line">        restart)</span><br><span class="line">                stop</span><br><span class="line">                sleep 2</span><br><span class="line">                start</span><br><span class="line">                ;;</span><br><span class="line">        *)</span><br><span class="line"></span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<blockquote>
<p>配置my.cnf配置文件</p>
</blockquote>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /mydata/3306/my.cnf</span></span><br><span class="line">[client]</span><br><span class="line">port 		= 3306</span><br><span class="line">socket 		= /mydata/3306/mysql.sock</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">no-auto-rehash</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">user 								= mysql</span><br><span class="line">port 								= 3306</span><br><span class="line">basedir 							= /usr/<span class="built_in">local</span>/mysqld</span><br><span class="line">datadir 							= /mydata/3306/data</span><br><span class="line">socket 								= /mydata/3306/mysql.sock        <span class="comment"># 本地套接字文件</span></span><br><span class="line">pid-file							= /mydata/3306/mysql.pid         <span class="comment"># 守护进程号文件</span></span><br><span class="line">server-id							= 1                              <span class="comment"># 服务序列号</span></span><br><span class="line">character-set-server                = utf8                           <span class="comment"># 默认服务字符集</span></span><br><span class="line"></span><br><span class="line">innodb_file_per_table 				= 0                              <span class="comment"># 关闭innodb数据库单文件存放在磁盘</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下为BINLOG</span></span><br><span class="line"><span class="built_in">log</span>-bin								= /mydata/3306/master-bin        <span class="comment"># 开启binlog日志</span></span><br><span class="line">log_bin_index 						= master-bin.index               <span class="comment"># binlog日志的索引</span></span><br><span class="line">binlog_format						= mixed                          <span class="comment"># binlog记录格式</span></span><br><span class="line">expire_logs_days                    = 7                              <span class="comment"># binlog日志保存天数</span></span><br><span class="line"><span class="built_in">log</span>-slave-updates                                                    <span class="comment"># 从库做级联日志</span></span><br><span class="line">binlog_cache_size                   = 1M</span><br><span class="line">max_binlog_cache_size               = 1M</span><br><span class="line">max_binlog_size                     = 2M</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下为慢查询LOG</span></span><br><span class="line">long_query_time                     = 10                             <span class="comment"># 最长查询时间，秒</span></span><br><span class="line">slow_query_log                      = OFF                            <span class="comment"># 慢查询日志开关 </span></span><br><span class="line">slow_query_log_file                 = /mydata/3306/data/mysql1-slow.log  <span class="comment"># 慢查询日志路径</span></span><br><span class="line">log_queries_not_using_indexes       = 1                              <span class="comment"># 开启记录未使用索引的查询</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下为普通查询日志和错误日志，错误日志在[mysqld_safe]内</span></span><br><span class="line"><span class="comment">#general_log                        = 0                              # 关闭普通查询日志</span></span><br><span class="line"><span class="comment">#general_log_file                   = /mydata/3306/mysql.log         # 普通日志路径</span></span><br><span class="line"><span class="comment">#log-error                          = /mydata/3306/error.log         # 错误日志路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下为查询缓存</span></span><br><span class="line">query_cache_size                    = 2M</span><br><span class="line">query_cache_limit                   = 1M</span><br><span class="line">query_cache_min_res_unit            = 2k</span><br><span class="line"></span><br><span class="line">slave-skip-errors                   = 1032,1062,1007                 <span class="comment"># 从库跳过简单错误</span></span><br><span class="line"></span><br><span class="line">innodb_log_buffer_size              = 2M </span><br><span class="line">innodb_log_file_size                = 4M</span><br><span class="line">innodb_log_files_in_group           = 3</span><br><span class="line">innodb_buffer_pool_size             = 32M</span><br><span class="line">innodb_data_file_path               = idbata1:128M:autoextend</span><br><span class="line">innodb_thread_concurrency           = 8</span><br><span class="line">innodb_flush_log_at_trx_commit      = 2</span><br><span class="line">innodb_max_dirty_pages_pct          = 90</span><br><span class="line">innodb_lock_wait_timeout            = 120</span><br><span class="line"></span><br><span class="line">relay-log 							= /mydata/3306/relay-bin         <span class="comment"># 从库中继日志</span></span><br><span class="line">relay-log-info-file 				= /mydata/3306/relay-log.info    <span class="comment"># 从库中继日志被执行信息日志</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span>-only                                                            <span class="comment"># 设置从库不能写入，读写分离用</span></span><br><span class="line"></span><br><span class="line">open_files_limit 					= 1024</span><br><span class="line">back_log 							= 600</span><br><span class="line">max_connections 					= 800</span><br><span class="line">max_connect_errors 					= 3000</span><br><span class="line"></span><br><span class="line">external_locking 					= FALSE</span><br><span class="line">max_allowed_packet 					= 8M</span><br><span class="line">sort_buffer_size 					= 1M</span><br><span class="line">join_buffer_size 					= 1M</span><br><span class="line"></span><br><span class="line">thread_cache_size					= 100</span><br><span class="line">thread_concurrency 					= 2</span><br><span class="line">thread_stack 						= 192k</span><br><span class="line"></span><br><span class="line">tmp_table_size 						= 2M</span><br><span class="line">max_heap_table_size 				= 2M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key_buffer_size 					= 16M</span><br><span class="line">read_buffer_size					= 1M</span><br><span class="line">bulk_insert_buffer_size 			= 1M</span><br><span class="line">lower_case_table_names				= 1</span><br><span class="line"><span class="comment"># skip-name-resolve</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># replicate-ignore-db 				= mysql # 从库忽略的数据库名</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># table_cache                       = 614</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># innodb_additional_mem_pool_size 	= 4M</span></span><br><span class="line"><span class="comment"># innodb_file_io_threads            = 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#myisam_sort_buffer_size 			= 1M</span></span><br><span class="line"><span class="comment">#myisam_max_sort_file_size 			= 10G</span></span><br><span class="line"><span class="comment">#myisam_max_extra_sort_file_size 	= 10G</span></span><br><span class="line"><span class="comment">#myisam_repair_treads 				= 1</span></span><br><span class="line"><span class="comment">#myisam_recover</span></span><br><span class="line"><span class="comment">#default_table_type 				= InnoDB</span></span><br><span class="line"><span class="comment">#transaction_isolation 				= READ-COMMITTED</span></span><br><span class="line"><span class="comment">#log_long_format</span></span><br></pre></td></tr></table></figure></div>



<blockquote>
<blockquote>
<p>以上两个脚本要修改相应的路径</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>初始化数据库</p>
</blockquote>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd /usr/local/mysql</span></span><br><span class="line"><span class="comment"># bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/mydata/3306/data</span></span><br><span class="line"><span class="comment"># bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/mydata/3307/data</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># /mydata/&#123;3306,3307&#125;/mysqld start</span></span><br><span class="line"><span class="comment"># netstat -tnulp | grep 330</span></span><br><span class="line">tcp        0      0 :::3306                     :::*                        LISTEN      10184/mysqld        </span><br><span class="line">tcp        0      0 :::3307                     :::*                        LISTEN      9911/mysqld </span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql -uroot -p初始化的密码 -S /mydata/3306/mysql.sock</span></span><br><span class="line">mysql&gt; <span class="built_in">set</span> password = password(<span class="string">'dldkshja'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql -uroot -p初始化的密码 -S /mydata/3307/mysql.sock</span></span><br><span class="line">mysql&gt; <span class="built_in">set</span> password = password(<span class="string">'dldkshja'</span>)</span><br></pre></td></tr></table></figure></div>

<h3 id="php"><a href="#php" class="headerlink" title="php"></a>php</h3><hr>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&gt; 编译</span><br><span class="line"><span class="comment"># wget http://cn2.php.net/distributions/php-5.6.26.tar.gz</span></span><br><span class="line"><span class="comment"># tar xf php-5.6.26.tar.gz</span></span><br><span class="line"><span class="comment"># cd php-5.6.26</span></span><br><span class="line">./configure \</span><br><span class="line">--prefix=/usr/<span class="built_in">local</span>/php \</span><br><span class="line">--with-config-file-path=/etc \</span><br><span class="line">--with-config-file-scan-dir=/etc/php.d \</span><br><span class="line">--sysconfdir=/etc \</span><br><span class="line">--<span class="built_in">enable</span>-fpm \						;开启php-fpm FastCGI；如php运行为httpd模块则：--with-apxs2=/usr/<span class="built_in">local</span>/apache/bin/apxs \</span><br><span class="line">--with-libxml-dir \</span><br><span class="line">--with-openssl \</span><br><span class="line">--without-sqlite3 \</span><br><span class="line">--without-pdo-sqlite \</span><br><span class="line">--with-zlib-dir \</span><br><span class="line">--with-pcre-dir \</span><br><span class="line">--with-mysql=mysqlnd \</span><br><span class="line">--with-mysqli=mysqlnd \</span><br><span class="line">--with-pdo-mysql=mysqlnd \</span><br><span class="line">--<span class="built_in">enable</span>-mysqlnd \</span><br><span class="line">--<span class="built_in">enable</span>-sockets \					;开启套接字方式支持</span><br><span class="line">--<span class="built_in">enable</span>-mbstring \					;支持多字符集</span><br><span class="line">--with-zlib \</span><br><span class="line">--with-bz2 \</span><br><span class="line">--<span class="built_in">enable</span>-zip \</span><br><span class="line">--with-gd \</span><br><span class="line">--with-png-dir \</span><br><span class="line">--with-jpeg-dir \</span><br><span class="line">--with-freetype-dir \</span><br><span class="line">--<span class="built_in">enable</span>-maintainer-zts	\			;支持httpd 的 worker、event模型</span><br><span class="line">--with-mcrypt						;支持加密库</span><br><span class="line"></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>环境配置</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mkdir /etc/php.d</span></span><br><span class="line"><span class="comment"># vim /etc/profile.d/php-fpm.sh</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/php/bin:/usr/<span class="built_in">local</span>/php/sbin</span><br><span class="line"><span class="comment"># source /etc/profile.d/php-fpm.sh</span></span><br><span class="line"><span class="comment"># vim /etc/ld.so.conf.d/php-fpm.conf</span></span><br><span class="line">/usr/<span class="built_in">local</span>/php/lib</span><br><span class="line"><span class="comment"># ldconfig</span></span><br><span class="line"><span class="comment"># ldconfig -p | grep php</span></span><br><span class="line"><span class="comment"># vim /etc/man.config</span></span><br><span class="line">MAN /usr/<span class="built_in">local</span>/php/man</span><br><span class="line"><span class="comment"># ln -sv /usr/local/php/include /usr/include/php</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cp php.ini-producation /etc/php.ini</span></span><br><span class="line"><span class="comment"># cp sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm</span></span><br><span class="line"><span class="comment"># chmod +x /etc/init.d/php-fpm</span></span><br><span class="line"><span class="comment"># chkconfig --add php-fpm</span></span><br><span class="line"><span class="comment"># cd /usr/local/php/</span></span><br><span class="line"><span class="comment"># cp etc/php-fpm.conf.default etc/php-fpm.conf</span></span><br><span class="line"><span class="comment"># vim etc/php-fpm.conf</span></span><br><span class="line">pm.max_children = 100</span><br><span class="line">pm.start_servers = 8</span><br><span class="line">pm.min_spare_servers = 2</span><br><span class="line">pm.max_spare_servers = 5</span><br><span class="line"></span><br><span class="line"><span class="comment"># server php-fpm start</span></span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>文件配置</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /www/html/index.php</span></span><br><span class="line">&lt;?php</span><br><span class="line">	<span class="variable">$conn</span> = mysql_connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'dldkshja'</span>);</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$conn</span>)</span><br><span class="line">		<span class="built_in">echo</span> access...;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> failure...;</span><br><span class="line">	mysql_close(<span class="variable">$conn</span>);</span><br><span class="line"></span><br><span class="line">	phpinfo();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>

<h3 id="xcache"><a href="#xcache" class="headerlink" title="xcache"></a>xcache</h3><hr>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">bash</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wget http://xcache.lighttpd.net/pub/Releases/3.2.0/xcache-3.2.0.tar.gz</span></span><br><span class="line"><span class="comment"># tar xf xcache-3.2.0.tar.gz</span></span><br><span class="line"><span class="comment"># cd xcache-3.2.0</span></span><br><span class="line"><span class="comment"># phpize</span></span><br><span class="line"><span class="comment"># ./configure --with-php-config=/usr/local/php/bin/php-config --enable-xcache</span></span><br><span class="line"><span class="comment"># cp xcache.ini /etc/php.d</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># service php-fpm restart</span></span><br></pre></td></tr></table></figure></div>
<h1 id="gt-LAMP-以上"><a href="#gt-LAMP-以上" class="headerlink" title="&gt; LAMP 以上"></a>&gt; LAMP 以上</h1></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">l10ng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://l10ng.github.io/posts/LAMP/">https://l10ng.github.io/posts/LAMP/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://l10ng.github.io">l10ng's</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/linux/">linux    </a><a class="post-meta__tags" href="/tags/lamp/">lamp    </a><a class="post-meta__tags" href="/tags/centos/">centos    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/l10ng/image@1.2/cover/cover60.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-full"><a href="/posts/ss-proxychains/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/l10ng/image@1.2/cover/cover6.jpg" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/l10ng/image@1.2/404.gif'"><div class="label">上一篇</div><div class="prev_info"><span>kali設置ss+proxychains透明代理</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: 'a5bf39a450eaf4f4de20',
  clientSecret: '3c64cac5a8dd3503d2d54d800ab2fc555b72c62e',
  repo: 'l10ng.github.io',
  owner: 'l10ng',
  admin: 'l10ng',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN',
  updateCountCallback: commentCount
})
gitalk.render('gitalk-container')

function commentCount(n){
  document.getElementsByClassName('gitalk-comment-count')[0].innerHTML= n
}</script></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By l10ng</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-sun-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-nest.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/click_heart.js"></script></body></html>